var TINY=TINY||{},T$=T$||function(n){return document.getElementById(n)},T$$$=T$$$||function(){return document.all?1:0};TINY.editor=function(){function t(t,f){var h,d,g,nt,tt,y,ht,p,rt,w,a,ct,b;this.n=t;window[t]=this;this.t=T$(f.id);this.obj=f;this.xhtml=f.xhtml;var l=document.createElement("div"),k=document.createElement("div"),s=document.createElement("div"),lt=f.controls?f.controls.length:i.length,v=0;for(this.i=document.createElement("iframe"),this.i.width=f.width||"530",this.i.height=f.height||"170",this.ie=T$$$(),s.className=f.rowclass||"tinyeditor-header",l.className=f.cssclass||"tinyeditor",l.style.width=this.i.width.toString().indexOf("%")>-1?this.i.width:this.i.width+"px",l.appendChild(s),v;v<lt;v++)if(h=f.controls?f.controls[v]:i[v],h=="n")s=document.createElement("div"),s.className=f.rowclass||"tinyeditor-header",l.appendChild(s);else if(h=="|")d=document.createElement("div"),d.className=f.dividerclass||"tinyeditor-divider",s.appendChild(d);else if(h=="font"){var o=document.createElement("select"),ut=f.fonts||["Arial","Consolas","Courier New","Georgia","Times New Roman","Verdana","SimSun"],at=ut.length,e=0;for(o.className="tinyeditor-font",o.onchange=new Function(this.n+'.ddaction(this, "fontname")'),o.options[0]=new Option("Font",""),e;e<at;e++)g=ut[e],o.options[e+1]=new Option(g,g);s.appendChild(o)}else if(h=="size"){var o=document.createElement("select"),ft=f.sizes||[1,2,3,4,5,6,7],et=ft.length,e=0;for(o.className="tinyeditor-size",o.onchange=new Function(this.n+'.ddaction(this, "fontsize")'),e;e<et;e++)nt=ft[e],o.options[e]=new Option(nt,nt);s.appendChild(o)}else if(h=="style"){var o=document.createElement("select"),ot=f.styles||[["Style",""],["Paragraph","<p>"],["Header 1","<h1>"],["Header 2","<h2>"],["Header 3","<h3>"],["Header 4","<h4>"],["Header 5","<h5>"],["Header 6","<h6>"]],et=ot.length,e=0;for(o.className="tinyeditor-style",o.onchange=new Function(this.n+'.ddaction(this, "formatblock")'),e;e<et;e++)tt=ot[e],o.options[e]=new Option(tt[0],tt[1]);s.appendChild(o)}else if(n[h]){var c=document.createElement("div"),e=n[h],vt=e[2],st,it=e[0]*u;c.className=f.controlclass||"tinyeditor-control";c.unselectable="on";c.style.backgroundPosition="0px "+it+"px";c.title=e[1];st=vt=="a"?'.action("'+e[3]+'", 0, '+(e[4]||0)+")":'.insert("'+e[4]+'", "'+e[5]+'", "'+e[3]+'")';c.onmousedown=new Function(this.n+(h=="print"?".print()":st));c.onmouseover=new Function(this.n+".hover(this, "+it+", 1)");c.onmouseout=new Function(this.n+".hover(this, "+it+", 0)");s.appendChild(c);this.ie&&(c.unselectable="on")}if(this.t.parentNode.insertBefore(l,this.t),this.t.style.width=this.i.width.toString().indexOf("%")>-1?this.i.width:this.i.width+"px",k.appendChild(this.t),k.appendChild(this.i),l.appendChild(k),this.t.style.display="none",(f.footer==null?!0:f.footer)&&(y=document.createElement("div"),y.className=f.footerclass||"tinyeditor-footer",(f.toggle?f.toggle:r)&&(ht=f.toggle?f.toggle:r,p=document.createElement("div"),p.className=ht.cssclass||"toggle",p.innerHTML=f.toggletext||"Source Code",p.onclick=new Function(this.n+".toggle(0, this);return false"),y.appendChild(p)),(f.resize==null?!0:f.resize)&&(rt=f.resize,w=document.createElement("div"),w.className=rt==null?"resize":rt.cssclass,w.onmousedown=new Function("event",this.n+".resize(event);return false"),w.onselectstart=function(){return!1},y.appendChild(w)),l.appendChild(y)),this.e=this.i.contentWindow.document,this.e.open(),a="<html><head>",ct=f.bodyid!=null?' id="'+f.bodyid+'"':' id="editorbox"',f.cssfile)for(b=0;b<f.cssfile.length;b++)a+='<link rel="stylesheet" href="'+f.cssfile[b]+'" />';if(f.css&&(a+='<style type="text/css">'+f.css+"<\/style>"),a+="<\/head><body"+ct+' contenteditable="true">'+(f.content||this.t.value),a+="<\/body><\/html>",this.e.write(a),this.e.close(),this.e.designMode="On",this.d=1,this.xhtml)try{this.e.execCommand("styleWithCSS",0,0)}catch(yt){try{this.e.execCommand("useCSS",0,1)}catch(yt){}}}var n=[],u=-30,i,r;return n.bold=[4,"Bold","a","bold"],n.italic=[5,"Italic","a","italic"],n.underline=[6,"Underline","a","underline"],n.strikethrough=[7,"Strikethrough","a","strikethrough"],n.subscript=[8,"Subscript","a","subscript"],n.superscript=[9,"Superscript","a","superscript"],n.orderedlist=[10,"Insert Ordered List","a","insertorderedlist"],n.unorderedlist=[11,"Insert Unordered List","a","insertunorderedlist"],n.outdent=[12,"Outdent","a","outdent"],n.indent=[13,"Indent","a","indent"],n.leftalign=[14,"Left Align","a","justifyleft"],n.centeralign=[15,"Center Align","a","justifycenter"],n.rightalign=[16,"Right Align","a","justifyright"],n.blockjustify=[17,"Block Justify","a","justifyfull"],n.undo=[18,"Undo","a","undo"],n.redo=[19,"Redo","a","redo"],n.image=[20,"Insert Image","i","insertimage","Enter Image URL:","http://"],n.hr=[21,"Insert Horizontal Rule","a","inserthorizontalrule"],n.link=[22,"Insert Hyperlink","i","createlink","Enter URL:","http://"],n.unlink=[23,"Remove Hyperlink","a","unlink"],n.unformat=[24,"Remove Formatting","a","removeformat"],n.print=[25,"Print","a","print"],i=["bold","italic","underline","strikethrough","subscript","superscript","|","leftalign","centeralign","rightalign","blockjustify","|","orderedlist","unorderedlist","|","outdent","indent","|","unformat","n","font","size","style","|","undo","redo","|","image","hr","link","unlink"],r={text:"Source Code",activetext:"Design Mode",cssclass:"toggle"},t.prototype.print=function(){this.i.contentWindow.print()},t.prototype.hover=function(n,t,i){this.getSelection();n.style.backgroundPosition=(i?"34px ":"0px ")+t+"px"},t.prototype.getSelection=function(){this.ie&&this.e.getSelection&&(this.sel=this.e.getSelection(),this.sel.getRangeAt&&this.sel.rangeCount&&(this.range=this.sel.getRangeAt(0)))},t.prototype.restoreSelection=function(){this.range&&this.ie&&this.e.getSelection&&(this.sel=this.e.getSelection(),this.sel.removeAllRanges(),this.sel.addRange(this.range))},t.prototype.ddaction=function(n,t){var i=n.selectedIndex,r=n.options[i].value;this.action(t,r)},t.prototype.action=function(n,t,i){i&&!this.ie?alert("Your browser does not support this function."):(this.restoreSelection(),this.e.execCommand(n,0,t||null))},t.prototype.insert=function(n,t,i){var r=prompt(n,t);r!=null&&r!=""&&this.e.execCommand(i,0,r)},t.prototype.setfont=function(){this.restoreSelection();execCommand("formatblock",0,hType)},t.prototype.resize=function(n){this.mv&&this.freeze();this.i.bcs=TINY.cursor.top(n);this.mv=new Function("event",this.n+".move(event)");this.sr=new Function(this.n+".freeze()");this.ie?(document.attachEvent("onmousemove",this.mv),document.attachEvent("onmouseup",this.sr)):(document.addEventListener("mousemove",this.mv,1),document.addEventListener("mouseup",this.sr,1))},t.prototype.move=function(n){var t=TINY.cursor.top(n);this.i.height=parseInt(this.i.height)+t-this.i.bcs;this.i.bcs=t},t.prototype.freeze=function(){this.ie?(document.detachEvent("onmousemove",this.mv),document.detachEvent("onmouseup",this.sr)):(document.removeEventListener("mousemove",this.mv,1),document.removeEventListener("mouseup",this.sr,1))},t.prototype.toggle=function(n,t){var i;this.d?(i=this.e.body.innerHTML,this.xhtml&&(i=i.replace(/<span class="apple-style-span">(.*)<\/span>/gi,"$1"),i=i.replace(/ class="apple-style-span"/gi,""),i=i.replace(/<span style="">/gi,""),i=i.replace(/<br>/gi,"<br />"),i=i.replace(/<br ?\/?>$/gi,""),i=i.replace(/^<br ?\/?>/gi,""),i=i.replace(/(<img [^>]+[^\/])>/gi,"$1 />"),i=i.replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1<\/strong>"),i=i.replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1<\/em>"),i=i.replace(/<u\b[^>]*>(.*?)<\/u[^>]*>/gi,'<span style="text-decoration:underline">$1<\/span>'),i=i.replace(/<(b|strong|em|i|u) style="font-weight:normal;?">(.*)<\/(b|strong|em|i|u)>/gi,"$2"),i=i.replace(/<(b|strong|em|i|u) style="(.*)">(.*)<\/(b|strong|em|i|u)>/gi,'<span style="$2"><$4>$3<\/$4><\/span>'),i=i.replace(/<span style="font-weight:normal;?">(.*)<\/span>/gi,"$1"),i=i.replace(/<span style="font-weight:bold;?">(.*)<\/span>/gi,"<strong>$1<\/strong>"),i=i.replace(/<span style="font-style:italic;?">(.*)<\/span>/gi,"<em>$1<\/em>"),i=i.replace(/<span style="font-weight:bold;?">(.*)<\/span>|<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1<\/strong>")),t&&(t.innerHTML=this.obj.toggletext||"Design Mode"),this.t.value=i,n||(this.t.style.width=this.i.width+(this.i.width.indexOf("px")<0&&this.i.width.indexOf("%")<0?"px":""),this.t.style.height=this.i.height+(this.i.height.indexOf("px")<0&&this.i.height.indexOf("%")<0?"px":""),this.i.style.display="none",this.t.style.display="block",this.d=0)):(i=this.t.value,t&&(t.innerHTML=this.obj.toggletext||"Source Code"),this.xhtml&&!this.ie&&(i=i.replace(/<strong>(.*)<\/strong>/gi,'<span style="font-weight:bold;">$1<\/span>'),i=i.replace(/<em>(.*)<\/em>/gi,'<span style="font-weight:italic;">$1<\/span>')),this.e.body.innerHTML=i,this.t.style.display="none",this.i.style.display="block",this.d=1)},t.prototype.post=function(){this.d&&this.toggle(1)},{edit:t}}();TINY.cursor=function(){return{top:function(n){return T$$$()?window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop:n.clientY+window.scrollY}}}();